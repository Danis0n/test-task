# Тестовое задание для Digital Budget

## Задание


Необходимо на базе **Spring Boot** сделать **REST API** приложение которое реализует следующий функционал:

### 1. Работа с пользователями:

- 1. Регистрация.
    - Обязательные поля:
        - email (проверка на валидность формата)
        - username (только символы латинского алфавита)
    - Необязательные поля:
        - Имя
- 2. Получение информации об авторизованном пользователем.
     Здесь и далее, пользователь является авторизованным, если в запросе присутствует заголовок **User-Id** со значением равным **ID** пользователя от которого должно выполняться действие.
     В ответе должны возвращаться следующие данные:
    - id
    - email
    - username
    - name
- 3. Редактирование данных авторизованного пользователя.
     Пользователь должен иметь возможность редактировать свои **username** и **имя**.
- 4. Удаление пользователя.
     В системе не может быть зарегистрировано два одинаковых **email** или **username**.

### 2. Работа с сервисом [The Movie Database](https://developers.themoviedb.org/3/getting-started/introduction):

- 1. Раз в 3 часа собирать 5 страниц фильмов из [Discover](https://developers.themoviedb.org/3/discover/movie-discover)
     Сохранять **title** и **poster_path**
     В базе не должно быть повторяющихся фильмов

### 3. Работа с сохраненными фильмами

- 1. Вывод всех сохраненных в базе фильмов с постраничной навигацией. По дефолту отдавать первые 15 фильмов
- 2. У пользователей должна быть возможность добавления фильмов в избранное.
- 3. У пользователя должна быть возможность удаления фильмов из избранного
- 4. Должен быть отдельный эндпоинт для вывода всех фильмов, которых у пользователя нет в избранном. В запросе должен передаваться **query параметр** **loaderType**. Должно быть реализовано 2 сервиса по поиску фильмов которых нет в избранном:
    - 4.1. С использованием SQL запроса для выборки **(loaderType=sql)**
    - 4.2. В памяти приложения. Загрузить список всех фильмов и список избранных фильмов пользователя, и среди всех найти те, которых нет в избранном **(loaderType=inMemory)**

Структуру базы, эндпоинты, успешные и неуспешные ответы сервиса продумать самостоятельно.
В случае возникновения исключений во время запроса, должен возвращаться **json** ответ **{“error”: “INTERNAL_ERROR”}** и статус **500**

## Запуск

Для запуска приложения требуется запустить базу данных и также добавить свой API ключ от MovieDB

Запуск бд:
```sh
docker-compose up
```

Добавить ключ необходимо в файл application-dev.yaml (Сделано так, чтобы API ключ не искался ботам спамерами)

API ключ: eyJhbGciOiJIUzI1NiJ9.
eyJhdWQiOiIyZTIzYzNjY2I3OTU3NDk5MDYwYWMyNWEyNDg2ZmMzOSIsInN1YiI6IjY1Y2EyZDBmZTRi
NTc2MDE0YTE0MGZlOSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.D8SmR8_kIH0S-oujzbnJ34sFkHxeTDJGC0ryXVLA_ic
(Работает для региона ирландия)
